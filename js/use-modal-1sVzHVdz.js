var Ze=Object.defineProperty,Ge=Object.defineProperties;var Qe=Object.getOwnPropertyDescriptors;var ae=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,Be=Object.prototype.propertyIsEnumerable;var re=(s,t,o)=>t in s?Ze(s,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[t]=o,y=(s,t)=>{for(var o in t||(t={}))Ce.call(t,o)&&re(s,o,t[o]);if(ae)for(var o of ae(t))Be.call(t,o)&&re(s,o,t[o]);return s},V=(s,t)=>Ge(s,Qe(t));var U=(s,t)=>{var o={};for(var a in s)Ce.call(s,a)&&t.indexOf(a)<0&&(o[a]=s[a]);if(s!=null&&ae)for(var a of ae(s))t.indexOf(a)<0&&Be.call(s,a)&&(o[a]=s[a]);return o};var J=(s,t,o)=>re(s,typeof t!="symbol"?t+"":t,o);var K=(s,t,o)=>new Promise((a,l)=>{var i=m=>{try{B(o.next(m))}catch(d){l(d)}},p=m=>{try{B(o.throw(m))}catch(d){l(d)}},B=m=>m.done?a(m.value):Promise.resolve(m.value).then(i,p);B((o=o.apply(s,t)).next())});import{a4 as T,aa as h,ab as f,a7 as e,af as et,ag as tt,ac as v,a8 as C,R as De,av as de,J as z,P as M,ar as ot,x as X,aq as w,aw as st,aV as R,aW as D,ad as ue,T as Te,a9 as at,ao as nt,az as lt,bF as ie,an as rt,Y as it,bJ as dt,aB as ut,ai as W,aj as Z,ah as ke,n as ce,aF as Ae,bb as ct,i as pt,k as we}from"../jse/index-index-DTL2YrKA.js";import{aR as pe,aV as $e,bm as ft,aZ as mt,T as yt,bn as ht,bo as vt,b0 as Ee,bp as gt,bq as bt,b5 as Ct,b4 as Bt,br as kt,bs as wt,bt as _t,bu as Ot,bv as xt,ba as Mt,be as Dt,aU as _e,bw as Tt,bx as At}from"./bootstrap-BlxcxLZz.js";const $t=pe("expand",[["path",{d:"m15 15 6 6",key:"1s409w"}],["path",{d:"m15 9 6-6",key:"ko1vev"}],["path",{d:"M21 16v5h-5",key:"1ck2sf"}],["path",{d:"M21 8V3h-5",key:"1qoq8a"}],["path",{d:"M3 16v5h5",key:"1t08am"}],["path",{d:"m3 21 6-6",key:"wwnumi"}],["path",{d:"M3 8V3h5",key:"1ln10m"}],["path",{d:"M9 9 3 3",key:"v551iv"}]]);const Et=pe("shrink",[["path",{d:"m15 15 6 6m-6-6v4.8m0-4.8h4.8",key:"17vawe"}],["path",{d:"M9 19.8V15m0 0H4.2M9 15l-6 6",key:"chjx8e"}],["path",{d:"M15 4.2V9m0 0h4.8M15 9l6-6",key:"lav6yq"}],["path",{d:"M9 4.2V9m0 0H4.2M9 9 3 3",key:"1pxi2q"}]]);const St=pe("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Lt=T({__name:"Dialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(s,{emit:t}){const l=$e(s,t);return(i,p)=>(f(),h(e(ft),et(tt(e(l))),{default:v(()=>[C(i.$slots,"default")]),_:3},16))}}),Pt=["data-dismissable-modal"],It=T({__name:"DialogOverlay",setup(s){mt();const t=De("DISMISSABLE_MODAL_ID");return(o,a)=>(f(),de("div",{"data-dismissable-modal":e(t),class:"bg-overlay z-popup inset-0"},null,8,Pt))}}),zt=T({__name:"DialogContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},animationType:{default:"slide"},appendTo:{default:"body"},class:{},closeClass:{},closeDisabled:{type:Boolean,default:!1},modal:{type:Boolean},open:{type:Boolean},overlayBlur:{},showClose:{type:Boolean,default:!0},zIndex:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus","close","closed","opened"],setup(s,{expose:t,emit:o}){const a=s,l=o,i=z(()=>{const $=a,{class:r,modal:u,open:g,showClose:k,animationType:_}=$;return U($,["class","modal","open","showClose","animationType"])});function p(){return a.appendTo==="body"||a.appendTo===document.body||!a.appendTo}const B=z(()=>p()?"fixed":"absolute"),m=$e(i,l),d=M(null);function c(r){var u;r.target===((u=d.value)==null?void 0:u.$el)&&(a.open?l("opened"):l("closed"))}return t({getContentRef:()=>d.value}),(r,u)=>(f(),h(ot,{defer:"",to:r.appendTo},[X(yt,{name:"fade"},{default:v(()=>[r.open&&r.modal?(f(),h(It,{key:0,style:st(V(y({},r.zIndex?{zIndex:r.zIndex}:{}),{position:B.value,backdropFilter:r.overlayBlur&&r.overlayBlur>0?`blur(${r.overlayBlur}px)`:"none"})),onClick:u[0]||(u[0]=()=>l("close"))},null,8,["style"])):w("",!0)]),_:1}),X(e(vt),ue({ref_key:"contentRef",ref:d,style:V(y({},r.zIndex?{zIndex:r.zIndex}:{}),{position:B.value}),onAnimationend:c},e(m),{class:e(D)("z-popup bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 w-full p-6 shadow-lg outline-none sm:rounded-xl",{"data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-top-[48%]":r.animationType==="slide"},a.class)}),{default:v(()=>[C(r.$slots,"default"),r.showClose?(f(),h(e(ht),{key:0,disabled:r.closeDisabled,class:R(e(D)("data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:bg-accent hover:text-accent-foreground text-foreground/80 flex-center absolute right-3 top-3 h-6 w-6 rounded-full px-1 text-lg opacity-70 transition-opacity hover:opacity-100 focus:outline-none disabled:pointer-events-none",a.closeClass)),onClick:u[1]||(u[1]=()=>l("close"))},{default:v(()=>[X(e(St),{class:"h-4 w-4"})]),_:1},8,["disabled","class"])):w("",!0)]),_:3},16,["style","class"])],8,["to"]))}}),Oe=T({__name:"DialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(s){const t=s,o=z(()=>{const p=t,{class:l}=p;return U(p,["class"])}),a=Ee(o);return(l,i)=>(f(),h(e(gt),ue(e(a),{class:e(D)("text-muted-foreground text-sm",t.class)}),{default:v(()=>[C(l.$slots,"default")]),_:3},16,["class"]))}}),Ft=T({__name:"DialogFooter",props:{class:{}},setup(s){const t=s;return(o,a)=>(f(),de("div",{class:R(e(D)("flex flex-row flex-col-reverse justify-end gap-x-2",t.class))},[C(o.$slots,"default")],2))}}),Vt=T({__name:"DialogHeader",props:{class:{}},setup(s){const t=s;return(o,a)=>(f(),de("div",{class:R(e(D)("flex flex-col gap-y-1.5 text-center sm:text-left",t.class))},[C(o.$slots,"default")],2))}}),xe=T({__name:"DialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(s){const t=s,o=z(()=>{const p=t,{class:l}=p;return U(p,["class"])}),a=Ee(o);return(l,i)=>(f(),h(e(bt),ue(e(a),{class:e(D)("text-lg font-semibold leading-none tracking-tight",t.class)}),{default:v(()=>[C(l.$slots,"default")]),_:3},16,["class"]))}});function Rt(s,t,o,a){const l=Te({offsetX:0,offsetY:0}),i=M(!1),p=c=>{const r=c.clientX,u=c.clientY;if(!s.value)return;const g=s.value.getBoundingClientRect(),{offsetX:k,offsetY:_}=l,A=g.left,$=g.top,Y=g.width,G=g.height;let S=null;if(a!=null&&a.value){const O=document.querySelector(a.value);O&&(S=O.getBoundingClientRect())}let q,j,H,L;if(S)H=S.left-A+k,q=S.right-A-Y+k,L=S.top-$+_,j=S.bottom-$-G+_;else{const O=document.documentElement,P=O.clientWidth,x=O.clientHeight;H=-A+k,L=-$+_,q=P-A-Y+k,j=x-$-G+_}const Q=O=>{let P=k+O.clientX-r,x=_+O.clientY-u;P=Math.min(Math.max(P,H),q),x=Math.min(Math.max(x,L),j),l.offsetX=P,l.offsetY=x,s.value&&(s.value.style.transform=`translate(${P}px, ${x}px)`,i.value=!0)},ee=()=>{i.value=!1,document.removeEventListener("mousemove",Q),document.removeEventListener("mouseup",ee)};document.addEventListener("mousemove",Q),document.addEventListener("mouseup",ee)},B=()=>{const c=ie(t);c&&s.value&&c.addEventListener("mousedown",p)},m=()=>{const c=ie(t);c&&s.value&&c.removeEventListener("mousedown",p)},d=()=>{l.offsetX=0,l.offsetY=0;const c=ie(s);c&&(c.style.transform="none")};return at(()=>{nt(()=>{o.value?B():m()})}),lt(()=>{m()}),{dragging:i,resetPosition:d,transform:l}}const Nt=T({__name:"modal",props:{modalApi:{default:void 0},animationType:{},appendToMain:{type:Boolean,default:!1},bordered:{type:Boolean},cancelText:{},centered:{type:Boolean},class:{},closable:{type:Boolean},closeOnClickModal:{type:Boolean},closeOnPressEscape:{type:Boolean},confirmDisabled:{type:Boolean},confirmLoading:{type:Boolean},confirmText:{},contentClass:{},description:{},destroyOnClose:{type:Boolean,default:!1},draggable:{type:Boolean},footer:{type:Boolean},footerClass:{},fullscreen:{type:Boolean},fullscreenButton:{type:Boolean},header:{type:Boolean},headerClass:{},loading:{type:Boolean},modal:{type:Boolean},openAutoFocus:{type:Boolean},overlayBlur:{},showCancelButton:{type:Boolean},showConfirmButton:{type:Boolean},submitting:{type:Boolean},title:{},titleTooltip:{},zIndex:{}},setup(s){var se,be;const t=s,o=Ct.getComponents(),a=M(),l=M(),i=M(),p=M(),B=M(),m=rt();Ae("DISMISSABLE_MODAL_ID",m);const{$t:d}=Bt(),{isMobile:c}=kt(),r=(be=(se=t.modalApi)==null?void 0:se.useStore)==null?void 0:be.call(se),{appendToMain:u,bordered:g,cancelText:k,centered:_,class:A,closable:$,closeOnClickModal:Y,closeOnPressEscape:G,confirmDisabled:S,confirmLoading:q,confirmText:j,contentClass:H,description:L,destroyOnClose:Q,draggable:ee,footer:O,footerClass:P,fullscreen:x,fullscreenButton:Se,header:fe,headerClass:Le,loading:me,modal:Pe,openAutoFocus:Ie,overlayBlur:ze,showCancelButton:Fe,showConfirmButton:Ve,submitting:E,title:te,titleTooltip:ye,animationType:Re,zIndex:Ne}=wt(t,r),oe=z(()=>x.value||c.value),he=z(()=>ee.value&&!oe.value&&fe.value),ve=z(()=>u.value?`#${_t}>div:not(.absolute)>div`:void 0),{dragging:Xe,transform:Ye}=Rt(i,p,he,ve),ne=M(!1),le=M(!0);it(()=>{var n;return(n=r==null?void 0:r.value)==null?void 0:n.isOpen},n=>K(null,null,function*(){if(n){if(le.value=!1,ne.value||(ne.value=!0),yield ce(),!a.value)return;const b=a.value.getContentRef();i.value=b.$el;const{offsetX:N,offsetY:F}=Ye;i.value.style.transform=`translate(${N}px, ${F}px)`}}),{immediate:!0}),dt(()=>{var n;u.value||(n=t.modalApi)==null||n.close()});function qe(){var n;(n=t.modalApi)==null||n.setState(b=>V(y({},b),{fullscreen:!x.value}))}function je(n){(!Y.value||E.value)&&(n.preventDefault(),n.stopPropagation())}function He(n){(!G.value||E.value)&&n.preventDefault()}function Ue(n){Ie.value||n==null||n.preventDefault()}function Je(n){const b=n.target,N=b==null?void 0:b.dataset.dismissableModal;(!Y.value||N!==m||E.value)&&(n.preventDefault(),n.stopPropagation())}function ge(n){n.preventDefault(),n.stopPropagation()}const Ke=z(()=>!e(Q)&&e(ne));function We(){var n;le.value=!0,(n=t.modalApi)==null||n.onClosed()}return(n,b)=>{var N;return f(),h(e(Lt),{modal:!1,open:(N=e(r))==null?void 0:N.isOpen,"onUpdate:open":b[3]||(b[3]=()=>{var F;return e(E)||(F=n.modalApi)==null?void 0:F.close()})},{default:v(()=>{var F;return[X(e(zt),{ref_key:"contentRef",ref:a,"append-to":ve.value,class:R(e(D)("left-0 right-0 top-[10vh] mx-auto flex max-h-[80%] w-[520px] flex-col p-0",oe.value?"sm:rounded-none":"sm:rounded-[var(--radius)]",e(A),{"border-border border":e(g),"shadow-3xl":!e(g),"left-0 top-0 size-full max-h-full !translate-x-0 !translate-y-0":oe.value,"top-1/2 !-translate-y-1/2":e(_)&&!oe.value,"duration-300":!e(Xe),hidden:le.value})),"force-mount":Ke.value,modal:e(Pe),open:(F=e(r))==null?void 0:F.isOpen,"show-close":e($),"animation-type":e(Re),"z-index":e(Ne),"overlay-blur":e(ze),"close-class":"top-3",onCloseAutoFocus:ge,onClosed:We,"close-disabled":e(E),onEscapeKeyDown:He,onFocusOutside:ge,onInteractOutside:je,onOpenAutoFocus:Ue,onOpened:b[2]||(b[2]=()=>{var I;return(I=n.modalApi)==null?void 0:I.onOpened()}),onPointerDownOutside:Je},{default:v(()=>[X(e(Vt),{ref_key:"headerRef",ref:p,class:R(e(D)("px-5 py-4",{"border-b":e(g),hidden:!e(fe),"cursor-move select-none":he.value},e(Le)))},{default:v(()=>[e(te)?(f(),h(e(xe),{key:0,class:"text-left"},{default:v(()=>[C(n.$slots,"title",{},()=>[W(Z(e(te))+" ",1),e(ye)?C(n.$slots,"titleTooltip",{key:0},()=>[X(e(Ot),{"trigger-class":"pb-1"},{default:v(()=>[W(Z(e(ye)),1)]),_:1})]):w("",!0)])]),_:3})):w("",!0),e(L)?(f(),h(e(Oe),{key:1},{default:v(()=>[C(n.$slots,"description",{},()=>[W(Z(e(L)),1)])]),_:3})):w("",!0),!e(te)||!e(L)?(f(),h(e(xt),{key:2},{default:v(()=>[e(te)?w("",!0):(f(),h(e(xe),{key:0})),e(L)?w("",!0):(f(),h(e(Oe),{key:1}))]),_:1})):w("",!0)]),_:3},8,["class"]),ut("div",{ref_key:"wrapperRef",ref:l,class:R(e(D)("relative min-h-40 flex-1 overflow-y-auto p-3",e(H),{"pointer-events-none":e(me)||e(E)}))},[C(n.$slots,"default")],2),e(me)||e(E)?(f(),h(e(Mt),{key:0,spinning:""})):w("",!0),e(Se)?(f(),h(e(Dt),{key:1,class:"hover:bg-accent hover:text-accent-foreground text-foreground/80 flex-center absolute right-10 top-3 hidden size-6 rounded-full px-1 text-lg opacity-70 transition-opacity hover:opacity-100 focus:outline-none disabled:pointer-events-none sm:block",onClick:qe},{default:v(()=>[e(x)?(f(),h(e(Et),{key:0,class:"size-3.5"})):(f(),h(e($t),{key:1,class:"size-3.5"}))]),_:1})):w("",!0),e(O)?(f(),h(e(Ft),{key:2,ref_key:"footerRef",ref:B,class:R(e(D)("flex-row items-center justify-end p-2",{"border-t":e(g)},e(P)))},{default:v(()=>[C(n.$slots,"prepend-footer"),C(n.$slots,"footer",{},()=>[e(Fe)?(f(),h(ke(e(o).DefaultButton||e(_e)),{key:0,variant:"ghost",disabled:e(E),onClick:b[0]||(b[0]=()=>{var I;return(I=n.modalApi)==null?void 0:I.onCancel()})},{default:v(()=>[C(n.$slots,"cancelText",{},()=>[W(Z(e(k)||e(d)("cancel")),1)])]),_:3},8,["disabled"])):w("",!0),C(n.$slots,"center-footer"),e(Ve)?(f(),h(ke(e(o).PrimaryButton||e(_e)),{key:1,disabled:e(S),loading:e(q)||e(E),onClick:b[1]||(b[1]=()=>{var I;return(I=n.modalApi)==null?void 0:I.onConfirm()})},{default:v(()=>[C(n.$slots,"confirmText",{},()=>[W(Z(e(j)||e(d)("confirm")),1)])]),_:3},8,["disabled","loading"])):w("",!0)]),C(n.$slots,"append-footer")]),_:3},8,["class"])):w("",!0)]),_:3},8,["append-to","class","force-mount","modal","open","show-close","animation-type","z-index","overlay-blur","close-disabled"])]}),_:3},8,["open"])}}});class Xt{constructor(t={}){J(this,"sharedData",{payload:{}});J(this,"store");J(this,"api");J(this,"state");const r=t,{connectedComponent:o,onBeforeClose:a,onCancel:l,onClosed:i,onConfirm:p,onOpenChange:B,onOpened:m}=r,d=U(r,["connectedComponent","onBeforeClose","onCancel","onClosed","onConfirm","onOpenChange","onOpened"]),c={bordered:!0,centered:!1,class:"",closeOnClickModal:!0,closeOnPressEscape:!0,confirmDisabled:!1,confirmLoading:!1,contentClass:"",destroyOnClose:!0,draggable:!1,footer:!0,footerClass:"",fullscreen:!1,fullscreenButton:!0,header:!0,headerClass:"",isOpen:!1,loading:!1,modal:!0,openAutoFocus:!1,showCancelButton:!0,showConfirmButton:!0,title:"",animationType:"slide"};this.store=new Tt(y(y({},c),d),{onUpdate:()=>{var g,k,_;const u=this.store.state;(u==null?void 0:u.isOpen)===((g=this.state)==null?void 0:g.isOpen)?this.state=u:(this.state=u,(_=(k=this.api).onOpenChange)==null||_.call(k,!!(u!=null&&u.isOpen)))}}),this.state=this.store.state,this.api={onBeforeClose:a,onCancel:l,onClosed:i,onConfirm:p,onOpenChange:B,onOpened:m},ct(this)}close(){return K(this,null,function*(){var o,a,l;((l=yield(a=(o=this.api).onBeforeClose)==null?void 0:a.call(o))!=null?l:!0)&&this.store.setState(i=>V(y({},i),{isOpen:!1}))})}getData(){var t,o;return(o=(t=this.sharedData)==null?void 0:t.payload)!=null?o:{}}lock(t=!0){return this.setState({submitting:t})}onCancel(){var t,o;this.api.onCancel?(o=(t=this.api).onCancel)==null||o.call(t):this.close()}onClosed(){var t,o;this.state.isOpen||(o=(t=this.api).onClosed)==null||o.call(t)}onConfirm(){var t,o;(o=(t=this.api).onConfirm)==null||o.call(t)}onOpened(){var t,o;this.state.isOpen&&((o=(t=this.api).onOpened)==null||o.call(t))}open(){this.store.setState(t=>V(y({},t),{isOpen:!0,submitting:!1}))}setData(t){return this.sharedData.payload=t,this}setState(t){return pt(t)?this.store.setState(t):this.store.setState(o=>y(y({},o),t)),this}unlock(){return this.lock(!1)}}const Me=Symbol("VBEN_MODAL_INJECT"),Yt={};function Jt(s={}){var m;const{connectedComponent:t}=s;if(t){const d=Te({}),c=M(!0);return[T((u,{attrs:g,slots:k})=>(Ae(Me,{extendApi(A){Object.setPrototypeOf(d,A)},options:s,reCreateModal(){return K(this,null,function*(){c.value=!1,yield ce(),c.value=!0})}}),qt(d,y(y(y({},u),g),k)),()=>we(c.value?t:"div",y(y({},u),g),k)),{name:"VbenParentModal",inheritAttrs:!1}),d]}const o=De(Me,{}),a=y(y(y({},Yt),o.options),s);a.onOpenChange=d=>{var c,r,u;(c=s.onOpenChange)==null||c.call(s,d),(u=(r=o.options)==null?void 0:r.onOpenChange)==null||u.call(r,d)};const l=a.onClosed;a.onClosed=()=>{var d;l==null||l(),a.destroyOnClose&&((d=o.reCreateModal)==null||d.call(o))};const i=new Xt(a),p=i;p.useStore=d=>At(i.store,d);const B=T((d,{attrs:c,slots:r})=>()=>we(Nt,V(y(y({},d),c),{modalApi:p}),r),{name:"VbenModal",inheritAttrs:!1});return(m=o.extendApi)==null||m.call(o,p),[B,p]}function qt(s,t){return K(this,null,function*(){var l;if(!t||Object.keys(t).length===0)return;yield ce();const o=(l=s==null?void 0:s.store)==null?void 0:l.state;if(!o)return;const a=new Set(Object.keys(o));for(const i of Object.keys(t))a.has(i)&&!["class"].includes(i)&&console.warn(`[Vben Modal]: When 'connectedComponent' exists, do not set props or slots '${i}', which will increase complexity. If you need to modify the props of Modal, please use useVbenModal or api.`)})}export{St as X,Jt as u};
