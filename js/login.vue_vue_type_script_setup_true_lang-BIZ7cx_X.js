var le=Object.defineProperty,ie=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var X=(o,t,n)=>t in o?le(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,I=(o,t)=>{for(var n in t||(t={}))Y.call(t,n)&&X(o,n,t[n]);if(z)for(var n of z(t))H.call(t,n)&&X(o,n,t[n]);return o},q=(o,t)=>ie(o,re(t));var F=(o,t)=>{var n={};for(var a in o)Y.call(o,a)&&t.indexOf(a)<0&&(n[a]=o[a]);if(o!=null&&z)for(var a of z(o))t.indexOf(a)<0&&H.call(o,a)&&(n[a]=o[a]);return n};var O=(o,t,n)=>new Promise((a,c)=>{var g=p=>{try{m(n.next(p))}catch(s){c(s)}},u=p=>{try{m(n.throw(p))}catch(s){c(s)}},m=p=>p.done?a(p.value):Promise.resolve(p.value).then(g,u);m((n=n.apply(o,t)).next())});import{aR as de,aV as ne,aW as ce,aX as ue,aY as pe,aZ as fe,a_ as me,T as ge,a$ as he,b0 as ae,b1 as be,b2 as _e,b3 as ye,b4 as se,b5 as we,b6 as ve,b7 as Ce,b8 as $e,aU as T,b9 as J,ba as ke,bb as Z,bc as Be,bd as Le,aS as b,be as S,bf as Pe,bg as Me,aT as Ae,bh as xe,bi as Te,aG as Re,bj as Ie,bk as ee}from"./bootstrap-BlxcxLZz.js";import{a4 as B,aa as _,ab as r,a7 as e,af as K,ag as G,ac as i,a8 as k,av as A,J as R,P as E,x as f,aq as v,aw as Se,ad as W,aW as V,a_ as te,a$ as De,k as D,aV as U,aB as w,ah as N,aj as $,ai as M,n as Ee,a as Ve,bI as ze,T as qe,a9 as Fe}from"../jse/index-index-DTL2YrKA.js";import{C as Oe,R as Ue,M as je,a as Ne,b as Qe,c as Ke}from"./index-Dy-le_1S.js";import{X as Ge,u as We}from"./use-modal-1sVzHVdz.js";const Xe=de("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Ye=B({__name:"AlertDialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean}},emits:["update:open"],setup(o,{emit:t}){const c=ne(o,t);return(g,u)=>(r(),_(e(ce),K(G(e(c))),{default:i(()=>[k(g.$slots,"default")]),_:3},16))}}),He=B({__name:"AlertDialogAction",props:{asChild:{type:Boolean},as:{}},setup(o){const t=o;return(n,a)=>(r(),_(e(ue),K(G(t)),{default:i(()=>[k(n.$slots,"default")]),_:3},16))}}),oe=B({__name:"AlertDialogCancel",props:{asChild:{type:Boolean},as:{}},setup(o){const t=o;return(n,a)=>(r(),_(e(pe),K(G(t)),{default:i(()=>[k(n.$slots,"default")]),_:3},16))}}),Je={class:"bg-overlay z-popup inset-0"},Ze=B({__name:"AlertDialogOverlay",setup(o){return fe(),(t,n)=>(r(),A("div",Je))}}),et=B({__name:"AlertDialogContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},centered:{type:Boolean},class:{},modal:{type:Boolean,default:!0},open:{type:Boolean},overlayBlur:{},zIndex:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus","close","closed","opened"],setup(o,{expose:t,emit:n}){const a=o,c=n,g=R(()=>{const l=a,{class:s,modal:h,open:L}=l;return F(l,["class","modal","open"])}),u=ne(g,c),m=E(null);function p(s){var h;s.target===((h=m.value)==null?void 0:h.$el)&&(a.open?c("opened"):c("closed"))}return t({getContentRef:()=>m.value}),(s,h)=>(r(),_(e(me),null,{default:i(()=>[f(ge,{name:"fade",appear:""},{default:i(()=>[s.open&&s.modal?(r(),_(Ze,{key:0,style:Se(q(I({},s.zIndex?{zIndex:s.zIndex}:{}),{position:"fixed",backdropFilter:s.overlayBlur&&s.overlayBlur>0?`blur(${s.overlayBlur}px)`:"none"})),onClick:h[0]||(h[0]=()=>c("close"))},null,8,["style"])):v("",!0)]),_:1}),f(e(he),W({ref_key:"contentRef",ref:m,style:q(I({},s.zIndex?{zIndex:s.zIndex}:{}),{position:"fixed"}),onAnimationend:p},e(u),{class:e(V)("z-popup bg-background p-6 shadow-lg outline-none sm:rounded-xl","data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-95","data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95",{"data-[state=open]:slide-in-from-top-[48%] data-[state=closed]:slide-out-to-top-[48%]":!s.centered,"data-[state=open]:slide-in-from-top-[98%] data-[state=closed]:slide-out-to-top-[148%]":s.centered,"top-[10vh]":!s.centered,"top-1/2 -translate-y-1/2":s.centered},a.class)}),{default:i(()=>[k(s.$slots,"default")]),_:3},16,["style","class"])]),_:3}))}}),tt=B({__name:"AlertDialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,n=R(()=>{const u=t,{class:c}=u;return F(u,["class"])}),a=ae(n);return(c,g)=>(r(),_(e(be),W(e(a),{class:e(V)("text-muted-foreground text-sm",t.class)}),{default:i(()=>[k(c.$slots,"default")]),_:3},16,["class"]))}}),ot=B({__name:"AlertDialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,n=R(()=>{const u=t,{class:c}=u;return F(u,["class"])}),a=ae(n);return(c,g)=>(r(),_(e(_e),W(e(a),{class:e(V)("text-lg font-semibold leading-none tracking-tight",t.class)}),{default:i(()=>[k(c.$slots,"default")]),_:3},16,["class"]))}}),[Dt,nt]=ye("VbenAlertContext"),at={class:"flex items-center"},st={class:"flex-auto"},lt={class:"m-4 min-h-[30px]"},it=B({__name:"alert",props:te({beforeClose:{},bordered:{type:Boolean,default:!0},buttonAlign:{default:"end"},cancelText:{},centered:{type:Boolean,default:!0},confirmText:{},containerClass:{},content:{},contentClass:{},contentMasking:{type:Boolean},footer:{},icon:{},overlayBlur:{},showCancel:{type:Boolean},title:{}},{open:{type:Boolean,default:!1},openModifiers:{}}),emits:te(["closed","confirm","opened"],["update:open"]),setup(o,{emit:t}){const n=o,a=t,c=De(o,"open"),{$t:g}=se(),u=we.getComponents(),m=E(!1);function p(){a("closed",m.value),m.value=!1}function s(){m.value=!1}const h=R(()=>{var x;let d=null;if(n.icon){if(typeof n.icon=="string")switch(n.icon){case"error":{d=D(Ce,{style:{color:"hsl(var(--destructive))"}});break}case"info":{d=D(Xe,{style:{color:"hsl(var(--info))"}});break}case"question":{d=$e;break}case"success":{d=D(Oe,{style:{color:"hsl(var(--success))"}});break}case"warning":{d=D(ve,{style:{color:"hsl(var(--warning))"}});break}default:{d=null;break}}}else d=(x=n.icon)!=null?x:null;return d});function L(){y(),j(!1)}function P(){l(),j(!1)}nt({doCancel:L,doConfirm:P});function l(){m.value=!0,a("confirm")}function y(){m.value=!1}const C=E(!1);function j(d){return O(this,null,function*(){if(yield Ee(),!d&&n.beforeClose){C.value=!0;try{(yield n.beforeClose({isConfirm:m.value}))!==!1&&(c.value=!1)}finally{C.value=!1}}else c.value=d})}return(d,x)=>(r(),_(e(Ye),{open:c.value,"onUpdate:open":j},{default:i(()=>[f(e(et),{open:c.value,centered:d.centered,"overlay-blur":d.overlayBlur,onOpened:x[0]||(x[0]=At=>a("opened")),onClosed:p,onEscapeKeyDown:s,class:U(e(V)(d.containerClass,"left-0 right-0 mx-auto flex max-h-[80%] flex-col p-0 duration-300 sm:w-[520px] sm:max-w-[80%] sm:rounded-[var(--radius)]",{"border-border border":d.bordered,"shadow-3xl":!d.bordered}))},{default:i(()=>[w("div",{class:U(e(V)("relative flex-1 overflow-y-auto p-3",d.contentClass))},[d.title?(r(),_(e(ot),{key:0},{default:i(()=>[w("div",at,[(r(),_(N(h.value),{class:"mr-2"})),w("span",st,$(e(g)(d.title)),1),d.showCancel?(r(),_(e(oe),{key:0,"as-child":""},{default:i(()=>[f(e(T),{variant:"ghost",size:"icon",class:"rounded-full",disabled:C.value,onClick:y},{default:i(()=>[f(e(Ge),{class:"text-muted-foreground size-4"})]),_:1},8,["disabled"])]),_:1})):v("",!0)])]),_:1})):v("",!0),f(e(tt),null,{default:i(()=>[w("div",lt,[f(e(J),{content:d.content,"render-br":""},null,8,["content"])]),C.value&&d.contentMasking?(r(),_(e(ke),{key:0,spinning:C.value},null,8,["spinning"])):v("",!0)]),_:1}),w("div",{class:U(["flex items-center justify-end gap-x-2",`justify-${d.buttonAlign}`])},[f(e(J),{content:d.footer},null,8,["content"]),d.showCancel?(r(),_(e(oe),{key:0,"as-child":""},{default:i(()=>[(r(),_(N(e(u).DefaultButton||e(T)),{disabled:C.value,variant:"ghost",onClick:y},{default:i(()=>[M($(d.cancelText||e(g)("cancel")),1)]),_:1},8,["disabled"]))]),_:1})):v("",!0),f(e(He),{"as-child":""},{default:i(()=>[(r(),_(N(e(u).PrimaryButton||e(T)),{loading:C.value,onClick:l},{default:i(()=>[M($(d.confirmText||e(g)("confirm")),1)]),_:1},8,["loading"]))]),_:1})],2)],2)]),_:1},8,["open","centered","overlay-blur","class"])]),_:1},8,["open"]))}}),Q=E([]),{$t:rt}=se();function dt(o,t,n){return new Promise((a,c)=>{var h,L;const g=Ve(o)?{content:o}:I({},o),u=document.createElement("div");document.body.append(u);const m={container:u,instance:null},p=q(I({onClosed:P=>{Q.value=Q.value.filter(l=>l!==m),Z(null,u),u.parentNode&&u.remove(),P?a():c(new Error("dialog cancelled"))}},g),{open:!0,title:(h=g.title)!=null?h:rt.value("prompt")}),s=D(it,p);Z(s,u),m.instance=(L=s.component)==null?void 0:L.proxy,Q.value.push(m)})}const ct={},ut={class:"mb-7 sm:mx-auto sm:w-full sm:max-w-md"},pt={class:"text-foreground mb-3 text-3xl font-bold leading-9 tracking-tight lg:text-4xl"},ft={class:"text-muted-foreground lg:text-md text-sm"};function mt(o,t){return r(),A("div",ut,[w("h2",pt,[k(o.$slots,"default")]),w("p",ft,[k(o.$slots,"desc")])])}const gt=Be(ct,[["render",mt]]),ht=B({__name:"dingding-login",props:{clientId:{},corpId:{},redirectUri:{},isQrCode:{type:Boolean}},setup(o){const t=o,n=Le(),[a,c]=We({header:!1,footer:!1,fullscreenButton:!1,class:"w-[302px] h-[302px] dingding-qrcode-login-modal",onOpened(){u()}}),g=()=>{const{redirectUri:p}=t;return p||window.location.origin+n.fullPath},u=()=>O(null,null,function*(){const{clientId:p,corpId:s}=t;window.DTFrameLogin||(yield ze("https://g.alicdn.com/dingding/h5-dingtalk-login/0.21.0/ddlogin.js")),window.DTFrameLogin({id:"dingding_qrcode_login_element",width:300,height:300},{redirect_uri:encodeURIComponent(g()),client_id:p,scope:"openid corpid",response_type:"code",state:"1",prompt:"consent",corpId:s},h=>{const{redirectUrl:L}=h;window.location.href=L},h=>{dt(`Login Error: ${h}`)})}),m=()=>{const{clientId:p,corpId:s,isQrCode:h}=t;h?c.open():window.location.href=`https://login.dingtalk.com/oauth2/auth?redirect_uri=${encodeURIComponent(g())}&response_type=code&client_id=${p}&scope=openid&corpid=${s}&prompt=consent`};return(p,s)=>(r(),A("div",null,[f(e(S),{onClick:m,tooltip:e(b)("authentication.dingdingLogin"),"tooltip-side":"top"},{default:i(()=>[f(e(Ue))]),_:1},8,["tooltip"]),f(e(a),null,{default:i(()=>s[0]||(s[0]=[w("div",{id:"dingding_qrcode_login_element"},null,-1)])),_:1,__:[0]})]))}}),bt={class:"w-full sm:mx-auto md:max-w-md"},_t={class:"mt-4 flex items-center justify-between"},yt={class:"text-muted-foreground text-center text-xs uppercase"},wt={class:"mt-4 flex flex-wrap justify-center"},vt=B({name:"ThirdPartyLogin",__name:"third-party-login",setup(o){const{auth:{dingding:t}}=Pe();return(n,a)=>(r(),A("div",bt,[w("div",_t,[a[0]||(a[0]=w("span",{class:"border-input w-[35%] border-b dark:border-gray-600"},null,-1)),w("span",yt,$(e(b)("authentication.thirdPartyLogin")),1),a[1]||(a[1]=w("span",{class:"border-input w-[35%] border-b dark:border-gray-600"},null,-1))]),w("div",wt,[f(e(S),{tooltip:e(b)("authentication.wechatLogin"),"tooltip-side":"top",class:"mb-3"},{default:i(()=>[f(e(je))]),_:1},8,["tooltip"]),f(e(S),{tooltip:e(b)("authentication.qqLogin"),"tooltip-side":"top",class:"mb-3"},{default:i(()=>[f(e(Ne))]),_:1},8,["tooltip"]),f(e(S),{tooltip:e(b)("authentication.githubLogin"),"tooltip-side":"top",class:"mb-3"},{default:i(()=>[f(e(Qe))]),_:1},8,["tooltip"]),f(e(S),{tooltip:e(b)("authentication.googleLogin"),"tooltip-side":"top",class:"mb-3"},{default:i(()=>[f(e(Ke))]),_:1},8,["tooltip"]),e(t)?(r(),_(ht,{key:0,"corp-id":e(t).corpId,"client-id":e(t).clientId,class:"mb-3"},null,8,["corp-id","client-id"])):v("",!0)])]))}}),Ct=["onKeydown"],$t={class:"text-muted-foreground"},kt={key:0,class:"mb-6 flex justify-between"},Bt={class:"flex-center"},Lt={key:1,class:"mb-2 mt-4 flex items-center justify-between"},Pt={key:0,class:"mt-3 text-center text-sm"},Mt=B({name:"AuthenticationLogin",__name:"login",props:{formSchema:{default:()=>[]},codeLoginPath:{default:"/auth/code-login"},forgetPasswordPath:{default:"/auth/forget-password"},loading:{type:Boolean,default:!1},qrCodeLoginPath:{default:"/auth/qrcode-login"},registerPath:{default:"/auth/register"},showCodeLogin:{type:Boolean,default:!0},showForgetPassword:{type:Boolean,default:!0},showQrcodeLogin:{type:Boolean,default:!0},showRegister:{type:Boolean,default:!0},showRememberMe:{type:Boolean,default:!0},showThirdPartyLogin:{type:Boolean,default:!0},subTitle:{default:""},title:{default:""},submitButtonText:{default:""}},emits:["submit"],setup(o,{expose:t,emit:n}){const a=o,c=n,[g,u]=Me(qe({commonConfig:{hideLabel:!0,hideRequiredMark:!0},schema:R(()=>a.formSchema),showDefaultActions:!1})),m=Ae(),p=`REMEMBER_ME_USERNAME_${location.hostname}`,s=localStorage.getItem(p)||"",h=E(!!s);function L(){return O(this,null,function*(){const{valid:l}=yield u.validate(),y=yield u.getValues();l&&(localStorage.setItem(p,h.value?y==null?void 0:y.username:""),c("submit",y))})}function P(l){m.push(l)}return Fe(()=>{s&&u.setFieldValue("username",s)}),t({getFormApi:()=>u}),(l,y)=>(r(),A("div",{onKeydown:Te(Re(L,["prevent"]),["enter"])},[k(l.$slots,"title",{},()=>[f(gt,null,{desc:i(()=>[w("span",$t,[k(l.$slots,"subTitle",{},()=>[M($(l.subTitle||e(b)("authentication.loginSubtitle")),1)])])]),default:i(()=>[k(l.$slots,"title",{},()=>[M($(l.title||`${e(b)("authentication.welcomeBack")} ðŸ‘‹ðŸ»`),1)])]),_:3})]),f(e(g)),l.showRememberMe||l.showForgetPassword?(r(),A("div",kt,[w("div",Bt,[l.showRememberMe?(r(),_(e(xe),{key:0,checked:h.value,"onUpdate:checked":y[0]||(y[0]=C=>h.value=C),name:"rememberMe"},{default:i(()=>[M($(e(b)("authentication.rememberMe")),1)]),_:1},8,["checked"])):v("",!0)]),l.showForgetPassword?(r(),A("span",{key:0,class:"vben-link text-sm font-normal",onClick:y[1]||(y[1]=C=>P(l.forgetPasswordPath))},$(e(b)("authentication.forgetPassword")),1)):v("",!0)])):v("",!0),f(e(T),{class:U([{"cursor-wait":l.loading},"w-full"]),loading:l.loading,"aria-label":"login",onClick:L},{default:i(()=>[M($(l.submitButtonText||e(b)("common.login")),1)]),_:1},8,["class","loading"]),l.showCodeLogin||l.showQrcodeLogin?(r(),A("div",Lt,[l.showCodeLogin?(r(),_(e(T),{key:0,class:"w-1/2",variant:"outline",onClick:y[2]||(y[2]=C=>P(l.codeLoginPath))},{default:i(()=>[M($(e(b)("authentication.mobileLogin")),1)]),_:1})):v("",!0),l.showQrcodeLogin?(r(),_(e(T),{key:1,class:"ml-4 w-1/2",variant:"outline",onClick:y[3]||(y[3]=C=>P(l.qrCodeLoginPath))},{default:i(()=>[M($(e(b)("authentication.qrcodeLogin")),1)]),_:1})):v("",!0)])):v("",!0),k(l.$slots,"third-party-login",{},()=>[l.showThirdPartyLogin?(r(),_(vt,{key:0})):v("",!0)]),k(l.$slots,"to-register",{},()=>[l.showRegister?(r(),A("div",Pt,[M($(e(b)("authentication.accountTip"))+" ",1),w("span",{class:"vben-link text-sm font-normal",onClick:y[4]||(y[4]=C=>P(l.registerPath))},$(e(b)("authentication.createAccount")),1)])):v("",!0)])],40,Ct))}}),Et=B({name:"Login",__name:"login",setup(o){const t=Ie(),n=R(()=>[{component:"VbenInput",componentProps:{placeholder:b("authentication.usernameTip")},defaultValue:"admin",fieldName:"username",label:b("authentication.username"),rules:ee().min(1,{message:b("authentication.usernameTip")})},{component:"VbenInputPassword",componentProps:{placeholder:b("authentication.password")},defaultValue:"123456",fieldName:"password",label:b("authentication.password"),rules:ee().min(1,{message:b("authentication.passwordTip")})}]);return(a,c)=>(r(),_(e(Mt),{"form-schema":n.value,loading:e(t).loginLoading,"show-code-login":!1,"show-forget-password":!1,"show-qrcode-login":!1,"show-register":!1,"show-third-party-login":!1,onSubmit:e(t).authLogin},null,8,["form-schema","loading","onSubmit"]))}});export{Et as _};
